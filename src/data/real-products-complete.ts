/**
 * Liste COMPLÃˆTE des produits rÃ©els depuis le fichier Excel de stock
 * Uniquement ces produits doivent apparaÃ®tre dans le header et le catalogue
 */

export const realProductsComplete = new Set([
  // ABYX (2 produits)
  "POWERBANK ABYX 10K MAH BLANC",
  "POWERBANK ABYX 10K MAH NOIR",

  // CABLES (5 produits)
  "CABLE TIGER POWER LITE 6 EN 1 AVEC APPLE WATCH",
  "ECOUTEUR CONDUCTION A AIR MATE GRIS",
  "ECOUTEUR CONDUCTION A AIR MATE NOIR",
  "ECOUTEUR CONDUCTION A AIR MATE ROUGE",
  "ROULEAUX PAPIER PHOTO X5 KIDPIC ENFANT",

  // HIFUTURE (71 produits)
  "CASQUE ANC HIFUTURE TOUR NOIR",
  "CASQUE ANC HIFUTURE TOUR X CHAMPAGNE",
  "CASQUE ANC HIFUTURE TOUR X NOIR",
  "ECOUTEUR FILLAIRE HIFUTURE HI5 CHAMPAGNE",
  "ECOUTEUR HIFUTURE FLYBUDS 4 ANC BEIGE",
  "ECOUTEUR HIFUTURE FLYBUDS 4 ANC NOIR",
  "ECOUTEUR HIFUTURE FLYBUDS 4 ANC ROSE CHAUD",
  "ECOUTEUR HIFUTURE OLYMBUDS 3 BLANC",
  "ECOUTEUR HIFUTURE OLYMBUDS 3 NOIR",
  "ECOUTEUR HIFUTURE SONIC AIR BLANC",
  "ECOUTEUR HIFUTURE SONIC AIR CHAMPAGNE",
  "ECOUTEUR HIFUTURE SONIC AIR NOIR",
  "ECOUTEUR HIFUTURE SONIFY CHAMPAGNE",
  "ECOUTEUR HIFUTURE SONIFY NOIR",
  "ECOUTEUR HIFUTURE YACHT BLACK GOLD",
  "ECOUTEUR HIFUTURE YACHT BLACK",
  "ECOUTEUR HIFUTURE YACHT ROSE",
  "ENCEINTE HIFUTURE ALTUS BLEU",
  "ENCEINTE HIFUTURE ALTUS CAMO VERT",
  "ENCEINTE HIFUTURE ALTUS NOIR",
  "ENCEINTE HIFUTURE ALTUS ROUGE",
  "ENCEINTE HIFUTURE ASCENDO NOIR",
  "ENCEINTE HIFUTURE ASCENDO ROSE",
  "ENCEINTE HIFUTURE GRAVITY BLEU",
  "ENCEINTE HIFUTURE GRAVITY NOIR",
  "ENCEINTE HIFUTURE RIPPLE BLEU",
  "ENCEINTE HIFUTURE RIPPLE NOIR",
  "ENCEINTE HIFUTURE RIPPLE ROUGE",
  "HIFUTURE MONTRE ACTIVE BLACK + RED",
  "HIFUTURE MONTRE ACTIVE SILVER",
  "HIFUTURE MONTRE EVO 2 BEIGE",
  "HIFUTURE MONTRE EVO 2 NOIR",
  "HIFUTURE MONTRE EVO 2 ROSE GOLD",
  "MONTRE HIFUTURE AIX GRISE ACIER",
  "MONTRE HIFUTURE AIX NOIR ACIER",
  "MONTRE HIFUTURE AURA 2 GRIS",
  "MONTRE HIFUTURE AURA 2 NOIR",
  "MONTRE HIFUTURE AURA 2 ROSE GOLD",
  "MONTRE HIFUTURE AURA GRIS",
  "MONTRE HIFUTURE AURA NOIR",
  "MONTRE HIFUTURE AURA ROSE",
  "MONTRE HIFUTURE AURORA BLEU",
  "MONTRE HIFUTURE AURORA BROWN",
  "MONTRE HIFUTURE AURORA SILVER",
  "MONTRE HIFUTURE GO PRO 2 GRIS",
  "MONTRE HIFUTURE GO PRO 2 NOIR",
  "MONTRE HIFUTURE GO PRO GRIS",
  "MONTRE HIFUTURE GO PRO NOIR",
  "MONTRE HIFUTURE LUME CHAMPAGNE",
  "MONTRE HIFUTURE LUME GRIS",
  "MONTRE HIFUTURE LUME NOIR",
  "MONTRE HIFUTURE LUME PRO NOIR",
  "MONTRE HIFUTURE LUME PRO PINK",
  "MONTRE HIFUTURE LUME PRO TITANIUM",
  "MONTRE HIFUTURE LUME PRO VERT",
  "MONTRE HIFUTURE LUME VERT",
  "MONTRE HIFUTURE MIX2 NOIR",
  "MONTRE HIFUTURE MIX2 ORANGE",
  "MONTRE HIFUTURE MIXX 3 JAUNE FLUO",
  "MONTRE HIFUTURE MIXX 3 NOIR",
  "MONTRE HIFUTURE ULTRA2 PRO BLACK",
  "MONTRE HIFUTURE ULTRA2 PRO GRISE",
  "MONTRE HIFUTURE ULTRA2 PRO ROSE",
  "MONTRE HIFUTURE VELA BEIGE",
  "MONTRE HIFUTURE VELA NOIR",
  "MONTRE HIFUTURE ZONE 2 GRIS",
  "MONTRE HIFUTURE ZONE 2 NOIR",
  "MONTRE HIFUTURE ZONE 2 ROSE",
  "PARTYBOX HIFUTURE EVENT HORIZON NOIR",
  "PARTYBOX HIFUTURE MUSICBOX NOIR",
  "PARTYBOX HIFUTURE VOCALIST 300 NOIR",

  // HONOR (19 produits)
  "HONOR CHOICE WATCH BLANC",
  "HONOR CHOICE WATCH NOIR",
  "HONOR PAD 9 WIFI 8+8/256",
  "HONOR X5",
  "HONOR X5B BLEU 4+4/64",
  "HONOR X5B NOIR 4+4/64",
  "HONOR X6B NOIR 6+6/128",
  "HONOR X6B VERT 6+6/128",
  "HONOR X7C NOIR 8+6/256",
  "HONOR X7C VERT 8+6/256",
  "HONOR X8B GRIS 8+8/512",
  "HONOR X8B NOIR 8+8/512",
  "HONOR X8B VERT 8+8/512",
  "HONOR X9B NOIR 12+8/256",
  "HONOR X9B ORANGE 12+8/256",
  "HONOR X9B VERT 12+8/256",
  "TELEPHONE HONOR 200 PRO BLANC 12+12/512",
  "TELEPHONE HONOR 200 PRO NOIR 12+12/512",
  "TELEPHONE HONOR 200 PRO VERT 12+12/512",

  // MONSTER (55 produits)
  "MONSTER BLASTER MICRO NOIR",
  "MONSTER CABLE HDMI ESSENTIAL 4K 1M8",
  "MONSTER CABLE HDMI ESSENTIAL 4K 3M6",
  "MONSTER CABLE HDMI ESSENTIAL 8K 1M8",
  "MONSTER CABLE TYPE C VERS HDMI 4K 2M",
  "MONSTER CASQUE HDTV",
  "MONSTER CHAMPION AIRLINKS",
  "MONSTER CLARITY 8.0 ANC AIRLINKS",
  "MONSTER DNA FIT",
  "MONSTER ELEMENT AIR",
  "MONSTER ENCEINTE CUBE 1 NOIR",
  "MONSTER ENCEINTE PARTY BOX SPARKLE",
  "MONSTER ENCEINTE PARTY MUSIC BOX GO + 2 MICRO",
  "MONSTER ENCEINTE S150 NOIR",
  "MONSTER ENCEINTE S150 PLUS NOIR",
  "MONSTER ENCEINTE TRAVELER",
  "MONSTER ILLUMINESCENCE BASIC AMPOULE A19 NON-SMART",
  "MONSTER ILLUMINESCENCE BASIC LED LIGHT BAR PAIR RGB INT",
  "MONSTER ILLUMINESCENCE BASIC LED TOUCH LIGHT X3 RGB INT",
  "MONSTER ILLUMINESCENCE BASIC LIGHT STRIP 2X 5M RGB+W SOUND REACTIVE INT",
  "MONSTER ILLUMINESCENCE BASIC LIGHT STRIP 30M RGB INT",
  "MONSTER ILLUMINESCENCE BASIC LIGHT STRIP 5M MULTICOLOR INT/EXT IPX6",
  "MONSTER ILLUMINESCENCE BASIC LIGHTSTRIP 2M COLOR/BLANC INT",
  "MONSTER ILLUMINESCENCE BASIC LIGHTSTRIP 2M MOTION REACTIVE PILES INT",
  "MONSTER ILLUMINESCENCE BASIC LIGHTSTRIP 2M MULTICOLOR SOUND FLOW INT",
  "MONSTER ILLUMINESCENCE BASIC LIGHTSTRIP 2M MULTICOULEUR INT",
  "MONSTER ILLUMINESCENCE BASIC LIGHTSTRIP 2M NEON RGB SOUND REACTIVE INT",
  "MONSTER ILLUMINESCENCE BASIC LIGHTSTRIP 4M MULTICOLOR SOUND FLOW INT",
  "MONSTER ILLUMINESCENCE BASIC LIGHTSTRIP 5M MULTICOLOR SOUND FLOW INT",
  "MONSTER ILLUMINESCENCE DUO + SOUND REACTIVE MONITOR LIGHT",
  "MONSTER ILLUMINESCENCE SMART BEAM + 2X BARS RGB IC SOUND REACTIVE",
  "MONSTER ILLUMINESCENCE SMART CHROMA LIGHT 2X BARS RGB IC",
  "MONSTER ILLUMINESCENCE SMART LIGHT STRIP 2M INT",
  "MONSTER ILLUMINESCENCE SMART LIGHT STRIP 2M MULTICOLOR FLOW INT",
  "MONSTER ILLUMINESCENCE SMART LIGHT STRIP 2X 5M RGB+W SOUND REACT INT",
  "MONSTER ILLUMINESCENCE SMART LIGHT STRIP 4M MULTICOLOR FLOW INT",
  "MONSTER ILLUMINESCENCE SMART LIGHT STRIP 5M NEON FLOW MULTICOLOR INT/EXT",
  "MONSTER ILLUMINESCENCE SMART LIGHT STRIP 5M NEON INT/EXT",
  "MONSTER ILLUMINESCENCE SMART LIGHT STRIP 5M RGB + IC FLOW INT",
  "MONSTER ILLUMINESCENCE SMART LIGHT STRIP 5M RGB+W SOUND REACT INT",
  "MONSTER ILLUMINESCENCE SMART PRISM II X6 RGB+IC FLOW",
  "MONSTER K20 BLEU",
  "MONSTER K20 ROSE",
  "MONSTER MISSION 100 BLANC",
  "MONSTER MISSION 100 NOIR",
  "MONSTER MULTIPRISE 4 PRISES",
  "MONSTER N LITE 203 GOLD",
  "MONSTER N LITE 203 NOIR",
  "MONSTER N LITE 206 BLANC",
  "MONSTER N LITE 206 NOIR",
  "MONSTER NETTOYANT ET LINGETTE 200ML",
  "MONSTER PERSONA SE ANC GRIS",
  "MONSTER PERSONA SE ANC NOIR",
  "MONSTER TH300 TACTILE BLANC",
  "MONSTER TH300 TACTILE NOIR",

  // MUVIT (7 produits)
  "APPAREIL PHOTO ENFANT MUVIT KIDPIC BLEU",
  "APPAREIL PHOTO ENFANT MUVIT KIDPIC ROSE",
  "CASQUE SANS FILS ENFANTS MUVIT CHAT",
  "CASQUE SANS FILS ENFANTS MUVIT DRAGON",
  "CASQUE SANS FILS ENFANTS MUVIT LAPIN",
  "CASQUE SANS FILS ENFANTS MUVIT LICORNE",
  "CASQUE SANS FILS ENFANTS MUVIT PIKA",

  // MY WAY (9 produits)
  "CABLE LUMINEUX MY WAY USB A - LIGHTNING",
  "CABLE LUMINEUX MY WAY USB A - USB C",
  "CABLE LUMINEUX MY WAY USB C - LIGHTNING",
  "CABLE LUMINEUX MY WAY USB C - USB C",
  "CABLE RETRACTABLE MY WAY USB C 3 EN 1 100 W",
  "CHARGEUR SANS FILS MY WAY 15W MAGSAFE DONUTS",
  "POWERBANK MY WAY 5K MAH MAGSAFE",
  "POWERBANK MYWAY 10K MAH",
  "POWERBANK MYWAY 20K MAH",

  // NOKIA (4 produits)
  "NOKIA 110 2023 NOIR",
  "NOKIA 110 4G 2025 BLEU",
  "NOKIA G22 BLEU",
  "NOKIA G22 GRIS",
]);

/**
 * Normaliser le nom d'un produit pour la comparaison
 */
export function normalizeForComparison(name: string): string {
  if (!name) return '';
  
  return name
    .toUpperCase()
    .replace(/[ðŸ“±ðŸŽ§âŒšðŸ’¡ðŸ”§ðŸ“¦]/g, '') // Enlever les emojis
    .replace(/\s+HT$/g, '') // Enlever HT Ã  la fin
    .replace(/\s+TTC$/g, '') // Enlever TTC Ã  la fin
    .replace(/\s+/g, ' ') // Normaliser les espaces
    .replace(/ML/g, 'ML') // Normaliser ml en ML
    .replace(/MAH/g, 'MAH') // Normaliser mah en MAH
    .trim();
}

/**
 * VÃ©rifier si un produit est rÃ©el (existe dans le stock Excel)
 */
export function isRealProductComplete(productName: string): boolean {
  if (!productName) return false;
  
  const normalized = normalizeForComparison(productName);
  
  // VÃ©rifier correspondance exacte
  for (const realProduct of realProductsComplete) {
    if (normalizeForComparison(realProduct) === normalized) {
      return true;
    }
  }
  
  // VÃ©rifier correspondances partielles pour gÃ©rer les variations
  for (const realProduct of realProductsComplete) {
    const realNormalized = normalizeForComparison(realProduct);
    
    // Pour HONOR, gÃ©rer les variations avec/sans "TELEPHONE"
    if (normalized.includes('HONOR') && realNormalized.includes('HONOR')) {
      const cleanNormalized = normalized.replace(/^TELEPHONE\s+/, '');
      const cleanReal = realNormalized.replace(/^TELEPHONE\s+/, '');
      if (cleanNormalized === cleanReal) return true;
    }
    
    // Pour HIFUTURE, gÃ©rer les variations avec/sans "MONTRE", "ECOUTEUR", "ENCEINTE"
    if (normalized.includes('HIFUTURE') && realNormalized.includes('HIFUTURE')) {
      const cleanNormalized = normalized.replace(/^(MONTRE|ECOUTEUR|ENCEINTE|CASQUE)\s+/, '');
      const cleanReal = realNormalized.replace(/^(MONTRE|ECOUTEUR|ENCEINTE|CASQUE)\s+/, '');
      if (cleanNormalized === cleanReal || realNormalized === normalized) return true;
    }
    
    // Pour MONSTER, gÃ©rer les variations
    if (normalized.includes('MONSTER') && realNormalized.includes('MONSTER')) {
      if (realNormalized === normalized) return true;
    }
  }
  
  return false;
}